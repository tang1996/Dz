<!DOCTYPE html> 
<html lang="en">

	<head>
		<meta charset="UTF-8">
		
		<title>服务员登录</title>

		<link rel="stylesheet" type="text/css" href="./login.css" />
		<link rel="stylesheet" type="text/css" href="../keyboard.css" />
		
		<script type="text/javascript" src="../../common/js/jquery-1.9.1.min.js"></script>
		<script type="text/javascript" src="../../common/js/jquery.cookie.js"></script>
		<script type="text/javascript" src="../../common/js/jquery.lazyload.min.js"></script>
		<script type="text/javascript" src="../../common/js/common.js"></script>
		<script type="text/javascript" src="../../common/js/baseUrl.js"></script>	
		<!-- 增加浏览器小图标 -->
<link rel="icon" href="../../common/images/logo.jpg" type="image/x-icon">
		<!--  IE 8 兼容性
		<script type="text/javascript" src="./js/html5shiv.min.js"></script>
		<script type="text/javascript" src="./js/selectivizr.min.js"></script>
		-->
<script type="text/javascript">
		
		var companyId='';
		var token='';
	
		function login() {

		var userName = document.getElementById("userName").value;
		var password = document.getElementById("password").value;
		
		if(userName.length < 0){	//用户名
			alert("请输入用户名");
			return	false
		}
		
		if(password.length < 0){
			alert("密码不能为空");
			return false
		}

			$.ajax( {
				type : 'POST',
				url : BASE_URL + LOGIN_ACTION.SERVICEUSERLOGIN,
				data : {
					userName : userName,
					password : password
				},
				success : function(data) {
					var success=data.success;
					var message=data.message;
					
					if(success){
						companyId=data.companyId;
						token=data.token
						//调用方法
						 $.cookie('userName', userName, { expires: 15, path:'/'});
		           		 $.cookie('token', token, { expires:15, path:'/'});
		           		 $.cookie('companyId', companyId, { expires: 15 ,path:'/'});
						//saveInfo();
						//window.open=BASE_URL+"/DzClient/serviceUser/index/index.html?companyId="+companyId+"&token="+token;
						window.location.href=BASE_URL+"/DzClient/serviceUser/index/index.html?";
					}else{
						alert(message);				
					}
				}
			});
	}
	
	//判断按钮是否被选中
	/*saveInfo = function () {
        try {
          	var isSave = document.getElementById('remember_password').checked;   //保存按键是否选中
            if (isSave) {
            var userName = document.getElementById("userName").value;
			var password = document.getElementById("password").value;
            if (userName != "" && password != "") {
                 	SetCookie(userName, password);
              	}
             } else {
                    SetCookie("", "");
                }
            } catch (e) {
 				
            }
       }
       
      function SetCookie(userName, password) {
            var Then = new Date();
			if(userName==''){
				//保存24小时(115200000是32个小时的毫秒值,GMT默认加8个小时)
				Then.setTime(Then.getTime() + 115200000);
			}else{
				//记住密码保存15天
          	 	Then.setTime(Then.getTime() + 1296000000);
			}*/
           	/*	 document.cookie = "userName=" + userName + "%%" + password + ";expires=" + Then.toGMTString();
           		 document.cookie = "token=" + token+";expires=" + Then.toGMTString();
           		 document.cookie = "companyId=" + companyId +";expires=" + Then.toGMTString();*/
         /*  		 $.cookie('userName', userName, { expires: 15 });
           		 $.cookie('token', token, { expires: 15 });
           		 $.cookie('companyId', companyId, { expires: 15 });
        }
 
        function GetCookie() {
            var nmpsd;
            var nm;
            var psd;
            var cookieString = new String(document.cookie);
            var cookieHeader = "userName=";
            var beginPosition = cookieString.indexOf(cookieHeader);
            cookieString = cookieString.substring(beginPosition);
            var ends = cookieString.indexOf(";");
            if (ends != -1) {
                cookieString = cookieString.substring(0, ends);
            }
            if (beginPosition > -1) {
                nmpsd = cookieString.substring(cookieHeader.length);
                if (nmpsd != "") {
                    beginPosition = nmpsd.indexOf("%%");
                    nm = nmpsd.substring(0, beginPosition);
                    psd = nmpsd.substring(beginPosition + 2);
                    document.getElementById("userName").value = nm;
                    document.getElementById("password").value = psd;
                    if (nm != "" && psd != "") {
                        document.getElementById('remember_password').checked = true;
                    }
                }
            }
        }  */
        
        
</script>
</head>


<body><!-- onLoad="document.getElementById('userName').focus();GetCookie();" -->
	<div class="ser ie">
		<img src="../../common/img/wel.png" alt="">
		
		<h3>欢迎进入商家点菜系统</h3>

		<form action="" method="post" id="login">
			<p class="input_p clear"> 
				<!--<label>用户名：</label> -->
				<input type="text" name="userName" placeholder="请输入用户名" id="userName" />
			</p>
			<p class="input_p clear">
				<!--<label>密码：</label>-->
				<input type="password"  name="password" placeholder="请输入密码" id="password" />
			</p>
			<div class="checkbox remember-password-container" id="remember">
				<label for="remember-me">
					<input type="checkbox" id="remember_password" />
					记住密码
				</label>
			</div>
			<input type="button" value="登  录" class="sub" onclick="login()" />
		</form>
	</div>
	
	
	
	<!-- 键盘  -->
<div id="container">
    <!-- <textarea id="write" rows="6" cols="60"></textarea> -->
    <div class="close"></div>
    <ul id="keyboard">
        <li class="symbol"><span class="off">`</span><span class="on">~</span></li>
        <li class="symbol"><span class="off">1</span><span class="on">!</span></li>
        <li class="symbol"><span class="off">2</span><span class="on">@</span></li>
        <li class="symbol"><span class="off">3</span><span class="on">#</span></li>
        <li class="symbol"><span class="off">4</span><span class="on">$</span></li>
        <li class="symbol"><span class="off">5</span><span class="on">%</span></li>
        <li class="symbol"><span class="off">6</span><span class="on">^</span></li>
        <li class="symbol"><span class="off">7</span><span class="on">&amp;</span></li>
        <li class="symbol"><span class="off">8</span><span class="on">*</span></li>
        <li class="symbol"><span class="off">9</span><span class="on">(</span></li>
        <li class="symbol"><span class="off">0</span><span class="on">)</span></li>
        <li class="symbol"><span class="off">-</span><span class="on">_</span></li>
        <li class="symbol"><span class="off">=</span><span class="on">+</span></li>
        <li class="delete lastitem">delete</li>
        <li class="tab">tab</li>
        <li class="letter">q</li>
        <li class="letter">w</li>
        <li class="letter">e</li>
        <li class="letter">r</li>
        <li class="letter">t</li>
        <li class="letter">y</li>
        <li class="letter">u</li>
        <li class="letter">i</li>
        <li class="letter">o</li>
        <li class="letter">p</li>
        <li class="symbol"><span class="off">[</span><span class="on">{</span></li>
        <li class="symbol"><span class="off">]</span><span class="on">}</span></li>
        <li class="symbol lastitem"><span class="off">\</span><span class="on">|</span></li>
        <li class="capslock">caps lock</li>
        <li class="letter">a</li>
        <li class="letter">s</li>
        <li class="letter">d</li>
        <li class="letter">f</li>
        <li class="letter">g</li>
        <li class="letter">h</li>
        <li class="letter">j</li>
        <li class="letter">k</li>
        <li class="letter">l</li>
        <li class="symbol"><span class="off">;</span><span class="on">:</span></li>
        <li class="symbol"><span class="off">'</span><span class="on">&quot;</span></li>
        <li class="return lastitem">return</li>
        <li class="left-shift">shift</li>
        <li class="letter">z</li>
        <li class="letter">x</li>
        <li class="letter">c</li>
        <li class="letter">v</li>
        <li class="letter">b</li>
        <li class="letter">n</li>
        <li class="letter">m</li>
        <li class="symbol"><span class="off">,</span><span class="on">&lt;</span></li>
        <li class="symbol"><span class="off">.</span><span class="on">&gt;</span></li>
        <li class="symbol"><span class="off">/</span><span class="on">?</span></li>
        <li class="right-shift lastitem">shift</li>
    </ul>
</div>
</body>
<script type="text/javascript">
	$(".close").click(function(){
		$("#container").css("display","none");
	});
	var $write = "";
    $("input").click(function(){
    	if($(this).attr("type") == "text" || $(this).attr("type") == "password"){
    		var write = "#" + $(this).attr("id");
	    	$write =$(write);
	    	$("#container").css("display","block");
    	}
    });
    var shift = false, capslock = false;
    $('#keyboard li').click(function () {
        var $this = $(this), character = $this.html();
        if ($this.hasClass('left-shift') || $this.hasClass('right-shift')) {
            $('.letter').toggleClass('uppercase');
            $('.symbol span').toggle();
            shift = (shift === true) ? false : true;
            capslock = false;
            return false;
        }
        if ($this.hasClass('capslock')) {
            $('.letter').toggleClass('uppercase');
            capslock = true;
            return false;
        }
        if ($this.hasClass('delete')) {
            var html = $write.val();
            $write.val(html.substr(0, html.length - 1));
            $write.focus();
            return false;
        }
        if ($this.hasClass('symbol')) character = $('span:visible', $this).html();
        if ($this.hasClass('space')) character = ' ';
        if ($this.hasClass('tab')) character = "\t";
        if ($this.hasClass('return')) character = "\n";
        if ($this.hasClass('uppercase')) character = character.toUpperCase();
        if (shift === true) {
            $('.symbol span').toggle();
            if (capslock === false) $('.letter').toggleClass('uppercase');
            shift = false;
        }
        $write.focus();
        $write.val($write.val() + character);
    });
</script>
</html>
